{% extends 'challenges/base.html' %}

{% block title %}ChallengeHub - {{ challenge.title }}{% endblock %}

{% block content %}
<div class="container-fluid px-4">
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li class="breadcrumb-item"><a href="{% url 'challenge_list' %}">–ß–µ–ª–ª–µ–Ω–¥–∂–∏</a></li>
            <li class="breadcrumb-item active">{{ challenge.title|truncatechars:30 }}</li>
        </ol>
    </nav>
    
    <div class="row g-4">
        <div class="col-lg-8 col-xl-9">
            <div class="card stat-card mb-4">
                <div class="card-body p-4">
                    <h1 class="mb-3">{{ challenge.title }}</h1>
                    
                    <div class="d-flex flex-wrap gap-2 mb-4">
                        <span class="badge bg-primary rounded-pill px-3 py-2 fs-6">{{ challenge.get_category_display }}</span>
                        <span class="badge bg-warning text-dark rounded-pill px-3 py-2 fs-6">{{ challenge.difficulty_stars }}</span>
                        <span class="badge bg-secondary rounded-pill px-3 py-2 fs-6">{{ challenge.duration_days }} –¥–Ω–µ–π</span>
                    </div>
                    
                    <div class="card mb-4 border-0 bg-light">
                        <div class="card-body">
                            <h5 class="card-title mb-3">–û–ø–∏—Å–∞–Ω–∏–µ</h5>
                            <p class="card-text fs-5">{{ challenge.description|linebreaks }}</p>
                        </div>
                    </div>
                    
                    <div class="card mb-4 border-0 bg-light">
                        <div class="card-body">
                            <h5 class="card-title mb-3">–ö–∞–∫ –≤—ã–ø–æ–ª–Ω—è—Ç—å</h5>
                            <ul class="fs-5 mb-0">
                                <li class="mb-2">–ù–∞—á–Ω–∏—Ç–µ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–µ–Ω—å</li>
                                <li class="mb-2">–û—Ç–º–µ—á–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ</li>
                                <li class="mb-2">–ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –±–æ–ª—å—à–µ 2 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</li>
                                <li>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-3 d-md-flex justify-content-md-start mt-5">
                        {% if user.is_authenticated %}
                            {% if user_challenge %}
                                <a href="{% url 'profile' %}" class="btn btn-success btn-custom px-5 py-3 fs-5">
                                    –í—ã —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ
                                </a>
                                <a href="{% url 'daily_checkin' user_challenge.id %}" class="btn btn-primary btn-custom px-5 py-3 fs-5">
                                    –û—Ç–º–µ—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è
                                </a>
                            {% else %}
                                <a href="{% url 'start_challenge' challenge.pk %}" class="btn btn-primary btn-custom px-5 py-3 fs-5 me-3">
                                    –ù–∞—á–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂
                                </a>
                                <a href="{% url 'challenge_list' %}" class="btn btn-outline-primary btn-custom px-4 py-3 fs-5">
                                    ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                                </a>
                            {% endif %}
                        {% else %}
                            <a href="{% url 'login' %}" class="btn btn-primary btn-custom px-5 py-3 fs-5 me-3">
                                –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å
                            </a>
                            <a href="{% url 'register' %}" class="btn btn-success btn-custom px-5 py-3 fs-5">
                                –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 col-xl-3">
            <div class="card stat-card sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title mb-0">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–µ–ª–ª–µ–Ω–¥–∂–∞</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                            <span>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
                            <strong>{{ challenge.get_category_display }}</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                            <span>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</span>
                            <strong>{{ challenge.difficulty_stars }}</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                            <span>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                            <strong>{{ challenge.duration_days }} –¥–Ω–µ–π</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                            <span>–°—Ç–∞—Ç—É—Å:</span>
                            <span class="badge bg-success rounded-pill">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                            <span>–°–æ–∑–¥–∞–Ω:</span>
                            <small class="text-muted">{{ challenge.created_at|date:"d.m.Y" }}</small>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="card stat-card mt-4">
                <div class="card-body">
                    <h6 class="mb-3">üí° –°–æ–≤–µ—Ç—ã –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</h6>
                    <ul class="small mb-0">
                        <li class="mb-2">–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –º–∞–ª–æ–≥–æ - –ø–µ—Ä–≤—ã–µ 3 –¥–Ω—è —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ</li>
                        <li class="mb-2">–°—Ç–∞–≤—å—Ç–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</li>
                        <li class="mb-2">–î–µ–ª–∏—Ç–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º —Å –¥—Ä—É–∑—å—è–º–∏</li>
                        <li class="mb-2">–ù–µ —Ä—É–≥–∞–π—Ç–µ —Å–µ–±—è –∑–∞ –ø—Ä–æ–ø—É—Å–∫–∏</li>
                        <li>–û—Ç–º–µ—á–∞–π—Ç–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–±–µ–¥—ã</li>
                    </ul>
                </div>
            </div>
            
            {% if user.is_authenticated and not user_challenge %}
            <div class="card stat-card mt-4 border-success">
                <div class="card-body">
                    <h6 class="mb-3">–ù–∞—á–Ω–∏—Ç–µ —Å–µ–π—á–∞—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ:</h6>
                    <ul class="small mb-0">
                        <li class="mb-2">–î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</li>
                        <li class="mb-2">–ì—Ä–∞—Ñ–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
                        <li class="mb-2">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –Ω–∞–≥—Ä–∞–¥—ã</li>
                        <li>–£–ª—É—á—à–µ–Ω–Ω—É—é –º–æ—Ç–∏–≤–∞—Ü–∏—é</li>
                    </ul>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}