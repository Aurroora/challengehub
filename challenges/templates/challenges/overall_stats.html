{% extends 'challenges/base.html' %}

{% block title %}ChallengeHub - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞{% endblock %}

{% block content %}
<div class="container">
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'profile' %}">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
            <li class="breadcrumb-item active">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
        </ol>
    </nav>
    
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h4 class="card-title mb-0">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
        </div>
        <div class="card-body">
            {% if not has_data %}
            <div class="alert alert-info">
                <h5>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h5>
                <p>{{ message }}</p>
                <a href="{% url 'challenge_list' %}" class="btn btn-primary">
                    –ù–∞—á–∞—Ç—å –ø–µ—Ä–≤—ã–π —á–µ–ª–ª–µ–Ω–¥–∂
                </a>
            </div>
            {% else %}
            
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="row mb-4">
                <div class="col-md-3 mb-3">
                    <div class="card text-center h-100">
                        <div class="card-body">
                            <div class="fs-1 mb-2">üéØ</div>
                            <h3>{{ statistics.total_challenges }}</h3>
                            <p class="card-text">–í—Å–µ–≥–æ —á–µ–ª–ª–µ–Ω–¥–∂–µ–π</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center h-100">
                        <div class="card-body">
                            <div class="fs-1 mb-2">‚úÖ</div>
                            <h3>{{ statistics.completed_challenges }}</h3>
                            <p class="card-text">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center h-100">
                        <div class="card-body">
                            <div class="fs-1 mb-2">üìä</div>
                            <h3>{{ statistics.avg_completion_rate }}%</h3>
                            <p class="card-text">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card text-center h-100">
                        <div class="card-body">
                            <div class="fs-1 mb-2">üìÖ</div>
                            <h3>{{ statistics.total_days_tracked }}</h3>
                            <p class="card-text">–î–Ω–µ–π —Ç—Ä–µ–∫–∏–Ω–≥–∞</p>
                        </div>
                    </div>
                </div>
            </div>
            
            {% for title, graph in graphs %}
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">{{ title }}</h5>
                </div>
                <div class="card-body">
                    {{ graph|safe }}
                </div>
            </div>
            {% endfor %}
            
            {% endif %}
        </div>
    </div>
    
    <div class="text-center mt-4">
        <a href="{% url 'profile' %}" class="btn btn-outline-secondary btn-custom px-4 py-2 me-2">
            ‚Üê –ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å
        </a>
        {% if user_challenge.status == 'active' %}
        <a href="{% url 'daily_checkin' user_challenge.id %}" class="btn btn-primary btn-custom px-4 py-2 me-2">
            üìù –°–¥–µ–ª–∞—Ç—å –æ—Ç–º–µ—Ç–∫—É
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}